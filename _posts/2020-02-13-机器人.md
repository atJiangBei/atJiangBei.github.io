---
layout: post
title: '机器人'
date: 2020-02-13
author: jiangbei
tags: toys
---


# 机器人

* <font color="#2ca6cb">某公司给我的面试题，意思就是做了这个面试题才能参加面试。</font>
* <font color="#2ca6cb">问题如下：</font>
* <font color="#2ca6cb">
设计一个遥控机器人：
			
			- 能在一个20x20的工作平台上进行作业。
			
			- 能接收5个指令：前进F、后退B、左转L、右转R、工作W；前进、后退指令可指定前进或后退的步数。
			
			- 当前进或后退的指令超出平台边缘，机器人会自动终止当前指令的执行。
			
			- 指令输入可以是一个序列，比如：F5LF2W，B3RF4WLF2等
			
			请用你熟悉的编程语言设计实现以上逻辑。
</font>

直接上代码吧：

```css
.box {
	height: 400px;
	width: 400px;
	border: 1px solid #1890FF;
	position: relative;
}

#robot {
	position: absolute;
	height: 20px;
	width: 20px;
}

#robot::after {
	content: '↑';
	position: absolute;
	border: 1px solid #666666;
	left: 0;
	top: 0;
	height: 100%;
	width: 100%;
	text-align: center;
	line-height: 20px;
}

```

```html

<p style="font-size: 14px;">
	设计一个遥控机器人：
	
	- 能在一个20x20的工作平台上进行作业。
	
	- 能接收5个指令：前进F、后退B、左转L、右转R、工作W；前进、后退指令可指定前进或后退的步数。
	
	- 当前进或后退的指令超出平台边缘，机器人会自动终止当前指令的执行。
	
	- 指令输入可以是一个序列，比如：F5LF2W，B3RF4WLF2等
	
	请用你熟悉的编程语言设计实现以上逻辑。
</p>
<div class="box">
	<div id="robot"></div>
</div>
<div>
	<p style="font-size: 14px;">案例：先右转，再前进12步，再右转，再前进9步，再左转，后退5步</p>
	<input id="text" value="RF12RF9LB5"/>
	<button id="btn">执行指令</button>
</div>


```


```javascript

class Robot {
		constructor(options) {
			this.el = options.el
			this.direction = options.direction || 1
			this.minX = 0
			this.minY = 0
			this.maxX = 19
			this.maxY = 19
			this.x = 0
			this.y = 0
			this.init()
		}
		init() {
			const _this = this
			document.onkeydown = function(e) {
				const keyCode = e.keyCode
				_this.parsingInstruction(keyCode)
			}
		}
		parsingInstruction(keyCode) {
			switch (keyCode) {
				case 70:
					console.log('前进F')
					this.forward()
					break;
				case 66:
					console.log('后退B')
					this.backOff()
					break;
				case 76:
					console.log('左转L')
					this.leftTurn()
					break;
				case 82:
					console.log('右转R')
					this.rightTurn()
					break;
				case 87:
					console.log('工作W')
					break;
				default:
					break;
			}
		}
		backOff() {
			switch (this.direction) {
				case 1:
					this.y += 1
					break;
				case 2:
					this.x -= 1
					break;
				case 3:
					this.y -= 1
					break;
				case 4:
					this.x += 1
					break;
			}
			this.setConf()
			this.setPosition()
		}
		forward() {
			switch (this.direction) {
				case 1:
					this.y -= 1
					break;
				case 2:
					this.x += 1
					break;
				case 3:
					this.y += 1
					break;
				case 4:
					this.x -= 1
					break;
			}
			this.setConf()
			this.setPosition()
		}
		setConf() {
			this.x = Math.max(this.x, this.minX)
			this.x = Math.min(this.x, this.maxX)
			this.y = Math.max(this.y, this.minY)
			this.y = Math.min(this.y, this.maxY)
		}
		setPosition() {
			this.el.style.left = this.x * 20 + 'px'
			this.el.style.top = this.y * 20 + 'px'
		}
		leftTurn() {
			this.direction--
			if (this.direction < 1) {
				this.direction = 4
			}
			this.toRunTo(this.direction)
		}
		rightTurn() {
			this.direction++
			if (this.direction > 4) {
				this.direction = 1
			}
			this.toRunTo(this.direction)
		}
		toRunTo(direction) {
			switch (direction) {
				case 1:
					this.el.style.transform = 'rotate(0deg)'
					break;
				case 2:
					this.el.style.transform = 'rotate(90deg)'
					break;
				case 3:
					this.el.style.transform = 'rotate(180deg)'
					break;
				case 4:
					this.el.style.transform = 'rotate(270deg)'
					break;
			}
		}
		async executionInstruction(str) {
			
			const numberReg = /[0-9]/
			const enReg = /[A-Z]/
			const arr = analysis(str)
			const length = arr.length
			console.log()
			for (let i = 0; i < arr.length; i++) {
				await this.implementStep(arr[i][0], arr[i][1])
			}
		}
		async implementStep(instructions, frequency) {
			const keyCode = this.transformation(instructions)
			const base = 200
			for(let i=0;i<frequency;i++){
				await new Promise(res=>{
					setTimeout(()=>{
						this.parsingInstruction(keyCode)
						res()
					},base)
				})
			}
			
			
		}
		transformation(instructions) {
			switch (instructions) {
				case 'F':
					return 70
				case 'B':
					return 66
				case 'L':
					return 76
				case 'R':
					return 82
				case 'W':
					return 87
			}
		}
	}
	function analysis(str){
		const arr = []
		let k = -1
		for (let i=0;i<str.length;i++) {
			const numberReg = /[0-9]/
			const enReg = /[A-Z]/
			if(!enReg.test(str[0])){
				throw new Error('首位必须为字母')
			}
			if (enReg.test(str[i])) {
				let next = i + 1
				k++
				arr[k] = [];
				arr[k].push(str[i])
				if(enReg.test(str[next])){
					arr[k].push(1)
				}
			}else{
				if(arr[k][1]){
					arr[k][1] = arr[k][1] + str[i]
				}else{
					arr[k][1] = str[i]
				}
			}
		}
		return arr.map(o=>[o[0],parseInt(o[1])])
	}
	const robot = new Robot({
		el: document.querySelector('#robot')
	})
	const btn = document.querySelector('#btn')
	const text = document.querySelector('#text')
	btn.onclick = function() {
		let str = text.value || "RF8RF9LB5";
		robot.executionInstruction(str)
	}

```

