---
layout: post
title: 'vueæ˜¯å¦‚ä½•é€šè¿‡this.keyæ‹¿åˆ°å½“å‰dataé‡Œé¢keyå€¼'
date: 2019-06-06
author: jiangbei
tags: vue
---

# ä»£ç†

**ç¤ºä¾‹**

```javascript

new Vue({
	el:'#app',
	data(){
		return{
			name:'vue'
		}	
	},
	methods:{
		say(){
			alert("Hello World")
		}
	},
	create(){
		this.name;// 'vue'
		this.say()
	}
})

```

å¾ˆç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬ç›´æ¥ä¸Šæºç å§ï¼ˆğŸ˜Šï¼‰

```javascript
// src/core/instance/state.js
let data = vm.$options.data
  data = vm._data = typeof data === 'function'
    ? getData(data, vm)
    : data || {}

 // proxy data on instance
  const keys = Object.keys(data)
  const props = vm.$options.props
  const methods = vm.$options.methods
  let i = keys.length
  while (i--) {
    const key = keys[i]
    if (process.env.NODE_ENV !== 'production') {
      if (methods && hasOwn(methods, key)) {
        warn(
          `Method "${key}" has already been defined as a data property.`,
          vm
        )
      }
    }
    if (props && hasOwn(props, key)) {
      process.env.NODE_ENV !== 'production' && warn(
        `The data property "${key}" is already declared as a prop. ` +
        `Use prop default value instead.`,
        vm
      )
    } else if (!isReserved(key)) {
      proxy(vm, `_data`, key)
    }
  }


```


æˆ‘ä»¬åªåˆ†æä¸æœ¬èŠ‚ç›¸å…³çš„å†…å®¹

```javascript

data = vm._data = typeof data === 'function'
    ? getData(data, vm)
    : data || {}


const keys = Object.keys(data)
let i = keys.length
while (i--) {
	const key = keys[i]
	
	proxy(vm, `_data`, key)
}

```

æˆ‘ä»¬æ‹¿åˆ°äº†dataçš„å€¼ï¼Œç„¶åéå†å®ƒï¼Œæœ€åæˆ‘ä»¬æ‰§è¡Œproxyæ–¹æ³•ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹proxyæ–¹æ³•

```javascript

const sharedPropertyDefinition = {
  enumerable: true,
  configurable: true,
  get: noop,
  set: noop
}

export function proxy (target: Object, sourceKey: string, key: string) {
  sharedPropertyDefinition.get = function proxyGetter () {
    return this[sourceKey][key]
  }
  sharedPropertyDefinition.set = function proxySetter (val) {
    this[sourceKey][key] = val
  }
  Object.defineProperty(target, key, sharedPropertyDefinition)
}

```

ä»¥ä¸Šï¼Œå½“æˆ‘ä»¬åœ¨å–this.nameå¾—æ—¶å€™ï¼Œé€šè¿‡Object.definePropertyè¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬æ— è®ºåœ¨å­˜å–å€¼å¾—æ—¶å€™ï¼Œéƒ½æ˜¯å¯¹å½“å‰å®ä¾‹ä¸‹çš„dataæ“ä½œçš„